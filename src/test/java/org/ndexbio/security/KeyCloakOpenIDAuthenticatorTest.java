package org.ndexbio.security;

import static org.junit.Assert.*;

import java.io.IOException;
import java.nio.file.Files;
import java.nio.file.Path;
import java.nio.file.Paths;
import java.security.NoSuchAlgorithmException;
import java.security.spec.InvalidKeySpecException;

import org.junit.Test;

import com.auth0.jwt.exceptions.TokenExpiredException;

public class KeyCloakOpenIDAuthenticatorTest {

	@Test
	public void test() throws InvalidKeySpecException, NoSuchAlgorithmException, IOException {
		
			
		String issuer = "http://localhost:8080/realms/googleauth";
		
		String pubKey = "MIIBIjANBgkqhkiG9w0BAQEFAAOCAQ8AMIIBCgKCAQEAw/YjkfKG6efWHGZZUZwwNoEo36Y766ZApzuaUo8i0X6ZtDn8NecCF1YVuYpgxKnibXI3afsyqFv6Wx0CI2+EQqElfMrx6riVltuKFl21LesQ/zQ5msAyKUqVimv+MwXUlpaeQpWixSQNGmk5JlZPAF3XvUAUGUTMBjPDb0uxJnh14fOpeLz2g1zgBt7KB7Z/uMPMLCNfI7aENhnM/xXIPhqsRl3Q98qzxXwBLvqVWEKF4Wp42mGwTY3n7YSspOXVft9zzph9x++VyGvgLgm5yRMlOuDfpuPVre1TEYf4Ica5Iveu64aQM7CI4tYCBcG7eIrXyzx96otk68OihwXqowIDAQAB";
		String idtoken = "eyJhbGciOiJSUzI1NiIsInR5cCIgOiAiSldUIiwia2lkIiA6ICJjR0RPVzBZUWlUclJ5bTM3SlcxNFZwM01MdkhZWEJEUEZ4Y2NqMmVPT25FIn0.eyJleHAiOjE2NzY0ODczODksImlhdCI6MTY3NjQ4NzA4OSwiYXV0aF90aW1lIjoxNjc2NDg2ODk1LCJqdGkiOiI2ZDBmNzNhMy05YjBjLTQyMmUtYTVkZC01ZWYwYWUzMjY0Y2EiLCJpc3MiOiJodHRwOi8vbG9jYWxob3N0OjgwODAvcmVhbG1zL2dvb2dsZWF1dGgiLCJhdWQiOiJteWNsaWVudCIsInN1YiI6IjM1ZjliMzU5LWFhNjctNGMxNC04M2Q4LTU2Y2RiZWEyN2U1NyIsInR5cCI6IklEIiwiYXpwIjoibXljbGllbnQiLCJub25jZSI6IjJiZGI5NmQ3LWI2YjktNGI5Yy04YjNjLTFiN2ZiZDVhNWYyMSIsInNlc3Npb25fc3RhdGUiOiI2OWYxYjg5Ni1jOTc4LTRkNTctODFkOS01MTI2YjhlNDNlMTkiLCJhdF9oYXNoIjoicm5FTEZ6UUEyVDNsM2pWa21Jb1VwdyIsImFjciI6IjAiLCJzaWQiOiI2OWYxYjg5Ni1jOTc4LTRkNTctODFkOS01MTI2YjhlNDNlMTkiLCJlbWFpbF92ZXJpZmllZCI6ZmFsc2UsIm5hbWUiOiJKaW5nIENoZW4iLCJwcmVmZXJyZWRfdXNlcm5hbWUiOiJqaW5namluZ2JpY0BnbWFpbC5jb20iLCJnaXZlbl9uYW1lIjoiSmluZyIsImZhbWlseV9uYW1lIjoiQ2hlbiIsImVtYWlsIjoiamluZ2ppbmdiaWNAZ21haWwuY29tIn0.s1pVaG6ekZ3BvRVFdX4VOb4VaBa1St4XkWMvzPlKxEPp1jtiMBHoO-u-wa6VboHZE3emqOTbHf-b1w45tiwaFOvQeiYEa-2Lt43DDNwDcr8jYkZKjIDDr0IKGjRn8Dni3qokOnBs7kMtOpCiCaBrzTapsrUr7l-cs5RHzqQUE1-_sLaTXXLoLNRpk04wgEu1PuELbNeDtIyq496nOV1pR5nlGEDFaZc0yByQo37g5W5QJWod6n1_AC0XeJgOf7U42YKIAv0t3jZxSVVgLQOtqV8TkCnusj7h96tM9Kh9HaU_fp0iMdTAq_Gp8mljJd5TcvDl8mHtI5LT76975ExiXw";
		
		KeyCloakOpenIDAuthenticator authenticator = new KeyCloakOpenIDAuthenticator(pubKey,issuer);
		try {
//			authenticator.getUserEmailFromIdToken(idtoken);
		} catch(TokenExpiredException e) {
			System.out.println(e.getMessage());
		}

		idtoken = "eyJhbGciOiJSUzI1NiIsInR5cCIgOiAiSldUIiwia2lkIiA6ICJjR0RPVzBZUWlUclJ5bTM3SlcxNFZwM01MdkhZWEJEUEZ4Y2NqMmVPT25FIn0.eyJleHAiOjE2NzY1MDk5OTYsImlhdCI6MTY3NjUwOTY5NiwiYXV0aF90aW1lIjoxNjc2NTA5Njk1LCJqdGkiOiJjNTRlZDI1OS0wYjcyLTRjZTUtYWExZS04YjYwYjkyMDc0ZGYiLCJpc3MiOiJodHRwOi8vbG9jYWxob3N0OjgwODAvcmVhbG1zL2dvb2dsZWF1dGgiLCJhdWQiOiJteWNsaWVudCIsInN1YiI6IjM1ZjliMzU5LWFhNjctNGMxNC04M2Q4LTU2Y2RiZWEyN2U1NyIsInR5cCI6IklEIiwiYXpwIjoibXljbGllbnQiLCJub25jZSI6IjZhMzE1YjllLWI0NzktNDgxMi05OTIwLTFkMWIyY2QxY2I4OSIsInNlc3Npb25fc3RhdGUiOiI2MWMwNzVlZi1jZmRhLTQ0OTEtODliYi0yYTQ5ZTdlYzk5MGEiLCJhdF9oYXNoIjoiRGlucVY2RUlzSlVRQTl3ZHVpUkw0ZyIsImFjciI6IjEiLCJzaWQiOiI2MWMwNzVlZi1jZmRhLTQ0OTEtODliYi0yYTQ5ZTdlYzk5MGEiLCJlbWFpbF92ZXJpZmllZCI6ZmFsc2UsIm5hbWUiOiJKaW5nIENoZW4iLCJwcmVmZXJyZWRfdXNlcm5hbWUiOiJqaW5namluZ2JpY0BnbWFpbC5jb20iLCJnaXZlbl9uYW1lIjoiSmluZyIsImZhbWlseV9uYW1lIjoiQ2hlbiIsImVtYWlsIjoiamluZ2ppbmdiaWNAZ21haWwuY29tIn0.eSG4CSvHNd17KOQKbYME4T_n90YLrIXArTaLjWeSwcTez5L0HWnfAhsQQNJZfjR3kxZw1jJQ7YzWaDCuiwq5Ui8kZC7XPAZ3IY4sSWNT4qf8hyvz5W5P10JTSqpf42QPwF9U6DwksBRxt2m65T0VLyQTln3z2uWBW2cseL0b_FrWoov0nigIk2P_XmXiNU4iZMmYfWXQ0lzFjkTwoDTz4zg4RT6OXKdvxh3D9Zu9DIwSvsFaiT1BG1bJFnShvK6-wB1U7H6FEeGjMx2RtBMFPqR0XFAIG24LD1f4aTj94W2uLK8bqatpJLyQodPnjQHP5BrKmsrRMU6Hw2KF5wG7HA";
	//	String email = authenticator.getUserEmailFromIdToken(idtoken);

	//System.out.println(email);
		//fail("Not yet implemented");
	}

}
